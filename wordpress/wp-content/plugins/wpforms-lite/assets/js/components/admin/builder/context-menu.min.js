var WPForms=window.WPForms||{};WPForms.Admin=WPForms.Admin||{},WPForms.Admin.Builder=WPForms.Admin.Builder||{},WPForms.Admin.Builder.ContextMenu=WPForms.Admin.Builder.ContextMenu||function(e,d,o){const s={},c={selectors:{contextMenu:".wpforms-context-menu",contextMenuItem:".wpforms-context-menu-list-item",contextMenuSelectiveItem:".wpforms-context-menu-list-item-selective",contextMenuDivider:".wpforms-context-menu-list-divider",builder:"#wpforms-builder"},init(){o(c.ready)},ready(){c.setup(),c.events()},setup(){s.$document=o(e),s.$contextMenu=o(c.selectors.contextMenu),s.$contextMenuItem=o(c.selectors.contextMenuItem),s.$contextMenuSelectiveItem=o(c.selectors.contextMenuSelectiveItem),s.$contextMenuDivider=o(c.selectors.contextMenuDivider),s.$builder=o(c.selectors.builder)},events(){s.$document.on("contextmenu",function(e){const t=o(e.target).closest(".wpforms-field");!o(e.target).closest(c.selectors.contextMenu).length&&t.length&&(e.preventDefault(),c.hideMenu(),setTimeout(function(){c.checkMenuItemsVisibility(t),c.checkDividerVisibility(),c.menuPositioning(e),c.menuItemClickAction(t),c.checkSelectiveMenuItemsState(t)},150))}),s.$document.on("click",c.hideMenuOnClick),s.$builder.on("wpformsFieldTabToggle",c.hideMenuOnClick)},menuItemClickAction(i){const n=i.data("field-id");s.$contextMenuItem.off("click").on("click",function(){const e=o(this);var t;e.hasClass("wpforms-context-menu-list-item-has-child")||((t={edit:()=>c.handleEditAction(i,n),duplicate:()=>c.handleDuplicateAction(i),delete:()=>c.handleDeleteAction(i),required:()=>c.handleRequiredAction(e,n),label:()=>c.handleLabelAction(e,n),"smart-logic":()=>c.handleSmartLogicAction(i,n),"field-size":()=>c.handleSizeAction(e,n)}[e.data("action")])&&t(),c.hideMenu())})},handleEditAction(e,t){e.trigger("click"),o(`#wpforms-field-option-basic-${t} .wpforms-field-option-group-toggle`).trigger("click")},handleDuplicateAction(e){e.find(".wpforms-field-duplicate").first().trigger("click")},handleDeleteAction(e){e.find(".wpforms-field-delete").first().trigger("click")},handleRequiredAction(e,t){o(`#wpforms-field-option-${t}-required`).trigger("click");t=c.checkRequiredState(t)?"active":"inactive";c.toggleItemText(e,t)},handleLabelAction(e,t){o(`#wpforms-field-option-${t}-label_hide`).trigger("click");t=c.checkLabelState(t)?"active":"inactive";c.toggleItemText(e,t)},handleSmartLogicAction(e,t){e.trigger("click"),o(`#wpforms-field-option-conditionals-${t} .wpforms-field-option-group-toggle`).trigger("click"),o(`#wpforms-field-option-${t} .wpforms-field-option-group-conditionals .education-modal`).trigger("click")},handleSizeAction(e,t){var i=e.data("value");o(`#wpforms-field-option-${t}-size`).val(i).trigger("change"),e.addClass("wpforms-context-menu-list-item-active").siblings().removeClass("wpforms-context-menu-list-item-active")},toggleItemText(e,t){var e=e.find(".wpforms-context-menu-list-item-text"),i=e.data("active-text"),n=e.data("inactive-text")||e.text();i&&(e.data("inactive-text",n),e.text("active"===t?i:n))},checkSelectiveMenuItemsState(e){const n=e.data("field-id");s.$contextMenuSelectiveItem.each(function(){var e=o(this),t=e.data("action");const i=e.data("value");(0,{required:()=>c.checkRequiredState(n),label:()=>c.checkLabelState(n),"field-size":()=>c.checkFieldSizeState(n,i)}[t])()?(e.addClass("wpforms-context-menu-list-item-active"),c.toggleItemText(e,"active")):(e.removeClass("wpforms-context-menu-list-item-active"),c.toggleItemText(e,"inactive"))})},checkRequiredState(e){return o(`#wpforms-field-option-${e}-required[type="checkbox"]`).is(":checked")},checkLabelState(e){return o(`#wpforms-field-option-${e}-label_hide[type="checkbox"]`).is(":checked")},checkFieldSizeState(e,t){return o(`#wpforms-field-option-${e}-size`).val()===t},menuPositioning(e){var t=s.$contextMenu.width(),i=s.$contextMenu.height(),n=d.innerWidth,o=d.innerHeight;s.$contextMenu.removeClass("wpforms-context-menu-selective-left");let c=e.pageY,l=e.pageX;e.pageY+i>o&&(c=o-i-15),e.pageX+t>n&&(l=n-t-15,s.$contextMenu.addClass("wpforms-context-menu-selective-left")),s.$contextMenu.css({top:c+"px",left:l+"px"}),s.$contextMenu.fadeIn(150)},checkMenuItemsVisibility(e){const t=e.data("field-id"),i={edit:()=>!1,duplicate:()=>c.shouldHideDuplicate(e),delete:()=>c.shouldHideDelete(e),required:()=>c.shouldHideRequired(t),label:()=>c.shouldHideLabel(t),"smart-logic":()=>c.shouldHideSmartLogic(t),"field-size":()=>c.shouldHideFieldSize(t,e)};s.$contextMenuItem.each(function(){var e=o(this),t=e.data("action");(0,i[t])()&&e.hide()})},shouldHideDuplicate(e){e=e.find(".wpforms-field-duplicate");return 0===e.length||"none"===e.css("display")},shouldHideDelete(e){e=e.find(".wpforms-field-delete");return 0===e.length||"none"===e.css("display")},shouldHideRequired(e){return 0===o(`#wpforms-field-option-${e}-required[type="checkbox"]`).length},shouldHideLabel(e){e=o(`#wpforms-field-option-${e}-label_hide[type="checkbox"]`);return 0===e.length||e.parents(".wpforms-field-option-row").hasClass("wpforms-disabled")},shouldHideFieldSize(e,t){t=0<t.closest(".wpforms-field-layout").length,e=o(`#wpforms-field-option-${e}-size`);return 0===e.length||t||e.parent().hasClass("wpforms-hidden")},shouldHideSmartLogic(e){return 0===o("#wpforms-field-option-conditionals-"+e).length&&0===o(`#wpforms-field-option-${e} .wpforms-field-option-group-conditionals .education-modal`).length},checkDividerVisibility(){s.$contextMenuDivider.each(function(){var e=o(this),t=e.data("visibility");let i=!0;t.split(",").forEach(function(e){"none"!==o('.wpforms-context-menu-list-item[data-action="'+e.trim()+'"]').css("display")&&(i=!1)}),i?e.hide():e.show()})},hideMenu(){s.$contextMenu.fadeOut(150),setTimeout(function(){s.$contextMenuItem.show()},150)},hideMenuOnClick(e){o(e.target).closest(c.selectors.contextMenu).length||c.hideMenu()}};return c}(document,window,jQuery),WPForms.Admin.Builder.ContextMenu.init();